#include "VisualGLCD_picgenios_objects.h"

// ------------------------------------------------------
// GLCD Picture name: handsOn_PaintEstrela.bmp
// GLCD Model: T6963C 128x128
// ------------------------------------------------------

const code char handsOn_PaintEstrela[] = {
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
124,   0,   0,   0,   0,   0,   0,   7, 224,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,   7, 224,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,   7, 240,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,  15, 240,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,  15, 240,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,  31, 248,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,  31, 248,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,  63, 252,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,  63, 252,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0,  63, 252,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0, 127, 254,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0, 127, 254,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0, 255, 255,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0, 255, 255,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   0, 255, 255,   0,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   1, 255, 255, 128,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   1, 255, 255, 128,   0,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   0,   3, 255, 255, 192,   0,   0,   0,   0,   0, 124,
124,   0,   0,   3, 255, 255, 255, 255, 255, 255, 255, 255, 192,   0,   0, 124,
124,   0,   0,   7, 255, 255, 255, 255, 255, 255, 255, 255, 224,   0,   0, 124,
124,   0,   0,  15, 255, 255, 255, 255, 255, 255, 255, 255, 240,   0,   0, 124,
124,   0,   0,  15, 255, 255, 255, 255, 255, 255, 255, 255, 240,   0,   0, 124,
124,   0,   0,   7, 255, 255, 255, 255, 255, 255, 255, 255, 224,   0,   0, 124,
124,   0,   0,   3, 255, 255, 255, 255, 255, 255, 255, 255, 192,   0,   0, 124,
124,   0,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255,   0,   0,   0, 124,
124,   0,   0,   0,  63, 255, 255, 255, 255, 255, 255, 254,   0,   0,   0, 124,
124,   0,   0,   0,  31, 255, 255, 255, 255, 255, 255, 248,   0,   0,   0, 124,
124,   0,   0,   0,   7, 255, 255, 255, 255, 255, 255, 224,   0,   0,   0, 124,
124,   0,   0,   0,   1, 255, 255, 255, 255, 255, 255, 128,   0,   0,   0, 124,
124,   0,   0,   0,   0, 255, 255, 255, 255, 255, 255,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  63, 255, 255, 255, 255, 252,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  15, 255, 255, 255, 255, 240,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   7, 255, 255, 255, 255, 224,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   1, 255, 255, 255, 255, 128,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   1, 255, 255, 255, 255, 128,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   1, 255, 255, 255, 255, 128,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   1, 255, 255, 255, 255, 128,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   3, 255, 255, 255, 255, 192,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   3, 255, 255, 255, 255, 192,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   7, 255, 255, 255, 255, 224,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   7, 255, 255, 255, 255, 224,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,   7, 255, 255, 255, 255, 224,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  15, 255, 255, 255, 255, 240,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  15, 255, 255, 255, 255, 240,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  15, 255, 254, 127, 255, 240,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  31, 255, 248,  31, 255, 248,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  31, 127, 224,   7, 254, 248,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  63, 255, 192,   3, 255, 252,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  63, 255,   0,   0, 255, 252,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0,  63, 252,   0,   0,  63, 252,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0, 127, 240,   0,   0,  15, 254,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0, 127, 192,   0,   0,   3, 254,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0, 127, 128,   0,   0,   0, 254,   0,   0,   0,   0, 124,
124,   0,   0,   0,   0, 126,   0,   0,   0,   0, 126,   0,   0,   0,   0, 124,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252,
127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252
};


unsigned char ucRecepcao = 0;

void interrupt() {

   if( RCIF_bit == 1) {
     ucRecepcao = UART1_Read(); //protocolo
     UART1_Write(ucRecepcao);
     RCIF_bit = 0;  //opcional para recepção serial
   }
}



void main() {
  unsigned char Texto[10];
  unsigned int Leitura_AN0;
  ADCON1 = 0B00001111; //TODOS OS PINOS COMO IO DIGITAL
  TRISD = 0;
  PORTD = 0;
  TRISB = 0;
  PORTB = 0;
  
  Start_TP();
  
  INTCON.GIEH = 1; //habilitar a chave geral das interrupções
  INTCON.GIEL = 1; //habilitar o vetor de baixa prioridade de interrupção
  RCON.IPEN = 1;  // define 2 level de interrupção PIC18F
  
  RCIF_bit = 0; //flag de sinalização na recepção serial
  RCIP_bit = 1; //alta prioridade de interrupçãos serial
  RCIE_bit = 1; //chave de ligação da interrupção na recepção serial
  UART1_Init(9600);

  while (1) {
    //Check_TP();
  switch(ucRecepcao)
  {
  case 'A' : { 
              DrawScreen(&Screen1); 
              ucRecepcao = 0;
              do{
               Leitura_AN0 = ADC_Read(0);          //0 a 1023
               Leitura_AN0 = Leitura_AN0 * (128/1023.);
               WordToStr(Leitura_AN0, Texto);      //00795

              Texto[5] = '%';
              Texto[6] = 0; //null terminação da cadeia
                                                            //8MHZ - 1/8mhz ->
              T6963C_write_text(Texto, 0, 7, T6963C_ROM_MODE_XOR );     //4*(FOSC/4) -> Ciclo maquina = FOSC 0,125us
              }while(ucRecepcao == 0);
              break; 
              }
  case 'B' : { DrawScreen(&Screen2); ucRecepcao = 0; break; }
  
  case 'C' : {
              T6963C_image(handsOn_PaintEstrela);
              ucRecepcao = 0;
              break;
              }
  }
  }

}
